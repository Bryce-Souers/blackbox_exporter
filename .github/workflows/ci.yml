---
name: CI
on:
  - push
  - pull_request
jobs:
  #test:
  #  strategy:
  #    matrix:
  #      os:
  #        - ubuntu-latest
  #        - windows-latest
  #        - macos-latest
  #  runs-on: ${{ matrix.os }}
  #  steps:
  #    - uses: actions/checkout@v4.2.2
  #    - uses: actions/setup-go@v5.2.0
  #      with:
  #        go-version: 1.23
  #    - run: make build
  #    - run: make test GOOPTS=-v

  build:
    strategy:
      matrix:
        thread: [0, 1, 2, 3, 4, 5]
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4.2.2

      - name: Import promci
        uses: prometheus/promci@v0.4.5

      - name: Cross-build for common architectures
        uses: ./.github/promci/actions/build
        with:
          thread: ${{ matrix.thread }}
          parallelism: 6
          promu_opts: -p linux
